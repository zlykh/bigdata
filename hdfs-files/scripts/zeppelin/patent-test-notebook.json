{"paragraphs":[{"text":"%spark\n\nimport scala.xml.{Elem, Node, NodeSeq}\n\nobject XmlUtils {\n\n  implicit class NodeSeq2(val node: NodeSeq) {\n    def attr(attr: String): String = (node \\ (\"@\" + attr)).toString()\n\n    def attrMap(): Map[String, String] = node.head.asInstanceOf[Elem].attributes.asAttrMap\n\n    //    def text(): String = node.text\n  }\n\n}\n\nabstract class UcidEntity {\n  val ucid: String\n}\n\ncase class Inventor(ucid: String,\n                    name: String,\n                    source: String,\n                    format: String) extends UcidEntity\n\ncase class Abstrct(ucid: String,\n                   text: String,\n                   source: String) extends UcidEntity\n\ncase class Title(ucid: String,\n                 text: String,\n                 source: String) extends UcidEntity\n                 \n                 object XmlPatentTag {\n  final val addressBookTag = \"addressbook\"\n  final val loadSourceTag = \"load-source\"\n  final val abstractTag = \"abstract\"\n  final val bibliographicDataTag = \"bibliographic-data\"\n  final val inventorsTag = \"inventors\"\n  final val inventorTag = \"inventor\"\n  final val technicalDataTag = \"technical-data\"\n  final val inventionTitleTaag = \"invention-title\"\n  final val partiesTag = \"parties\"\n  final val firstNameTag = \"first-name\"\n  final val lastNameTag = \"last-name\"\n}\n\nobject XmlPatentAttr {\n  final val ucidAttr = \"ucid\"\n  final val formatAttr = \"format\"\n}","dateUpdated":"2019-06-05T08:28:12+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":true,"results":{},"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1559723236570_-1903012636","id":"20190530-220000_509995786","result":{"code":"SUCCESS","type":"TEXT","msg":"import scala.xml.{Elem, Node, NodeSeq}\ndefined module XmlUtils\ndefined class UcidEntity\ndefined class Inventor\ndefined class Abstrct\ndefined class Title\ndefined module XmlPatentTag\ndefined module XmlPatentAttr\n"},"dateCreated":"2019-06-05T08:27:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1243"},{"text":"%spark\n\n  \nimport XmlPatentTag._\nimport XmlPatentAttr._\n    \n    def textToRootNode(text: String): Elem = {\n    //    val xml: Elem = scala.xml.XML.loadFile(\"p.xml\")\n    scala.xml.XML.loadString(text)\n  }\n  \n    def extractInventors(root: Elem): Seq[Inventor] = {\n    val ucid = (root \\ (\"@\" + ucidAttr)).toString()\n    val inventorsNode = root \\ bibliographicDataTag \\ partiesTag \\ inventorsTag\n    inventorsNode.flatMap(node => node \\ inventorTag)\n      .map(inventorNode => {\n        val loadSource =  (inventorNode \\ (\"@\" + loadSourceTag)).toString()\n        val format = (inventorNode \\ (\"@\" + formatAttr)).toString()\n        val node = inventorNode \\ addressBookTag\n        val last = (node \\ lastNameTag).text.trim.replaceAll(\"[!@#$%^&*()<>,.:;'\\\"]\", \"\").toUpperCase\n        val first = (node \\ firstNameTag).text.trim.replaceAll(\"[!@#$%^&*()<>,.:;'\\\"]\", \"\").toUpperCase\n        Inventor(ucid, (last + \" \" + first).trim, loadSource, format)\n      })\n      .distinct\n  }\n  \n    def extractAbstracts(root: Elem): Seq[Abstrct] = {\n    val ucid = (root \\ (\"@\" + ucidAttr)).toString()\n    val abstractNode = root \\ abstractTag\n    abstractNode.map(node => Abstrct(ucid, node.text, (node \\ (\"@\" + loadSourceTag)).toString()))\n  }\n\n  def extractTitles(root: Elem): Seq[Title] = {\n    val ucid = (root \\ (\"@\" + ucidAttr)).toString()\n    val titleNode = root \\ bibliographicDataTag \\ technicalDataTag \\ inventionTitleTaag\n    titleNode.map(node => Title(ucid, node.text, (node \\ (\"@\" + loadSourceTag)).toString()))\n  }\n  ","dateUpdated":"2019-06-05T08:30:13+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":true,"results":{},"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1559723236575_-1904936381","id":"20190530-220043_163938428","result":{"code":"SUCCESS","type":"TEXT","msg":"import XmlPatentTag._\nimport XmlPatentAttr._\ntextToRootNode: (text: String)scala.xml.Elem\nextractInventors: (root: scala.xml.Elem)Seq[Inventor]\nextractAbstracts: (root: scala.xml.Elem)Seq[Abstrct]\nextractTitles: (root: scala.xml.Elem)Seq[Title]\n"},"dateCreated":"2019-06-05T08:27:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1244"},{"text":"%spark\nimport sqlContext.implicits._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\n\nval rawTexts = sc.textFile(\"/user/maria_dev/xxxx/part-m-00000\")\nval rootNodes = rawTexts.map(textToRootNode)\n    \nval inventors = rootNodes.flatMap(extractInventors).toDF().cache()\nval abstracts = rootNodes.flatMap(extractAbstracts).toDF().cache()\nval titles = rootNodes.flatMap(extractTitles).toDF().cache()\n","dateUpdated":"2019-06-05T08:32:37+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1559723236575_-1904936381","id":"20190530-221738_1265918264","result":{"code":"SUCCESS","type":"TEXT","msg":"import sqlContext.implicits._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\nrawTexts: org.apache.spark.rdd.RDD[String] = /user/maria_dev/xxx/part-m-00000 MapPartitionsRDD[159] at textFile at <console>:136\nrootNodes: org.apache.spark.rdd.RDD[scala.xml.Elem] = MapPartitionsRDD[160] at map at <console>:140\ninventors: org.apache.spark.sql.DataFrame = [ucid: string, name: string, source: string, format: string]\nabstracts: org.apache.spark.sql.DataFrame = [ucid: string, text: string, source: string]\ntitles: org.apache.spark.sql.DataFrame = [ucid: string, text: string, source: string]\n"},"dateCreated":"2019-06-05T08:27:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1245"},{"text":"%spark\n\n// inventors.registerTempTable(\"invents\")\n// inventors.show()\n// abstracts.show()\n// titles.show()\n\nval inventorsGrouped = inventors.groupBy(\"ucid\",\"source\").agg(concat_ws(\", \", collect_list(\"name\")) as \"names\")\n//inventorsGrouped.show\n\ntitles\n    .filter(\"source = 'patent-office'\")\n    .join(abstracts, abstracts(\"ucid\") === titles(\"ucid\") && abstracts(\"source\") === titles(\"source\"))\n    .join(inventorsGrouped, inventorsGrouped(\"ucid\") === titles(\"ucid\") && inventorsGrouped(\"source\") === titles(\"source\"))\n    .select(\n            titles(\"ucid\"), \n            abstracts(\"text\") as \"abstract\", \n            inventorsGrouped(\"names\") as \"inventors\", \n            inventorsGrouped(\"source\")\n        )\n    .show\n\n//inventors.select(\"name\").distinct.show","dateUpdated":"2019-06-05T08:34:08+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1559723236576_-1919172090","id":"20190531-071403_561938082","result":{"code":"SUCCESS","type":"TEXT","msg":"inventorsGrouped: org.apache.spark.sql.DataFrame = [ucid: string, source: string, names: string]\n+------------+--------------------+--------------------+-------------+\n|        ucid|            abstract|           inventors|       source|\n+------------+--------------------+--------------------+-------------+\n|US-5551211-A|An apparatus for ...|KENNEDY PAUL, PRO...|patent-office|\n|US-5551210-A|A machine for pac...| WILLIAMSON ROBERT L|patent-office|\n|US-5551209-A|The present inven...|MOLINA ERNEST, CH...|patent-office|\n|US-5551208-A|A method for manu...|    VAN ERDEN DONALD|patent-office|\n+------------+--------------------+--------------------+-------------+\n\n"},"dateCreated":"2019-06-05T08:27:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1246"},{"text":"%sql\n\nselect * from invents","dateUpdated":"2019-06-05T08:34:45+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"pieChart","height":300,"optionOpen":true,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"ucid":"string","name":"string","source":"string","format":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","stacked":false},"stackedAreaChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"pieChart":{},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"source","index":2,"aggr":"sum"}],"groups":[],"values":[{"name":"format","index":3,"aggr":"count"}]},"helium":{}},"1":{"graph":{"mode":"table","height":87.2,"optionOpen":false}}},"enabled":true,"graph":{"mode":"stackedAreaChart","height":300,"optionOpen":true,"keys":[{"name":"ucid","index":0,"aggr":"sum","$$hashKey":"object:1993"}],"values":[{"name":"name","index":1,"aggr":"count","$$hashKey":"object:1996"}],"groups":[],"scatter":{"xAxis":{"name":"ucid","index":0,"aggr":"sum"},"yAxis":{"name":"name","index":1,"aggr":"sum"}}},"editorHide":false},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1559723236576_-1919172090","id":"20190530-222401_1739372081","result":{"code":"SUCCESS","type":"TABLE","msg":"ucid\tname\tsource\tformat\nUS-5551211-A\tKENNEDY PAUL\tdocdb\tepo\nUS-5551211-A\tKENNEDY PAUL\tdocdb\tintermediate\nUS-5551211-A\tKENNEDY PAUL\tpatent-office\toriginal\nUS-5551211-A\tPROCHUT RICHARD\tdocdb\tepo\nUS-5551211-A\tPROCHUT RICHARD\tdocdb\tintermediate\nUS-5551211-A\tPROCHUT RICHARD\tpatent-office\toriginal\nUS-5551211-A\tLOEFSTEDT JOERGEN\tdocdb\tepo\nUS-5551211-A\tL+EUML O+EE FSTEDT J+EUML O+EE RGEN\tdocdb\tintermediate\nUS-5551211-A\tLOFSTEDT JORGEN\tpatent-office\toriginal\nUS-5551211-A\tYOKOYAMA IKURO\tdocdb\tepo\nUS-5551211-A\tYOKOYAMA IKURO\tdocdb\tintermediate\nUS-5551211-A\tYOKOYAMA IKURO\tpatent-office\toriginal\nUS-5551211-A\tNILSSON CHRISTER\tdocdb\tepo\nUS-5551211-A\tNILSSON CHRISTER\tdocdb\tintermediate\nUS-5551211-A\tNILSSON CHRISTER\tpatent-office\toriginal\nUS-5551210-A\tWILLIAMSON ROBERT L\tdocdb\tepo\nUS-5551210-A\tWILLIAMSON ROBERT L\tdocdb\tintermediate\nUS-5551210-A\tWILLIAMSON ROBERT L\tpatent-office\toriginal\nUS-5551209-A\tMOLINA ERNEST\tdocdb\tepo\nUS-5551209-A\tMOLINA ERNEST\tdocdb\tintermediate\nUS-5551209-A\tMOLINA ERNEST\tpatent-office\toriginal\nUS-5551209-A\tCHENEVARD ALEXIS\tdocdb\tepo\nUS-5551209-A\tCHENEVARD ALEXIS\tdocdb\tintermediate\nUS-5551209-A\tCHENEVARD ALEXIS\tpatent-office\toriginal\nUS-5551208-A\tVAN ERDEN DONALD\tdocdb\tepo\nUS-5551208-A\tVAN ERDEN DONALD\tdocdb\tintermediate\nUS-5551208-A\tVAN ERDEN DONALD\tpatent-office\toriginal\n","comment":"","msgTable":[[{"key":"name","value":"US-5551211-A"},{"key":"name","value":"KENNEDY PAUL"},{"key":"name","value":"docdb"},{"key":"name","value":"epo"}],[{"key":"source","value":"US-5551211-A"},{"key":"source","value":"KENNEDY PAUL"},{"key":"source","value":"docdb"},{"key":"source","value":"intermediate"}],[{"key":"format","value":"US-5551211-A"},{"key":"format","value":"KENNEDY PAUL"},{"key":"format","value":"patent-office"},{"key":"format","value":"original"}],[{"value":"US-5551211-A"},{"value":"PROCHUT RICHARD"},{"value":"docdb"},{"value":"epo"}],[{"value":"US-5551211-A"},{"value":"PROCHUT RICHARD"},{"value":"docdb"},{"value":"intermediate"}],[{"value":"US-5551211-A"},{"value":"PROCHUT RICHARD"},{"value":"patent-office"},{"value":"original"}],[{"value":"US-5551211-A"},{"value":"LOEFSTEDT JOERGEN"},{"value":"docdb"},{"value":"epo"}],[{"value":"US-5551211-A"},{"value":"L+EUML O+EE FSTEDT J+EUML O+EE RGEN"},{"value":"docdb"},{"value":"intermediate"}],[{"value":"US-5551211-A"},{"value":"LOFSTEDT JORGEN"},{"value":"patent-office"},{"value":"original"}],[{"value":"US-5551211-A"},{"value":"YOKOYAMA IKURO"},{"value":"docdb"},{"value":"epo"}],[{"value":"US-5551211-A"},{"value":"YOKOYAMA IKURO"},{"value":"docdb"},{"value":"intermediate"}],[{"value":"US-5551211-A"},{"value":"YOKOYAMA IKURO"},{"value":"patent-office"},{"value":"original"}],[{"value":"US-5551211-A"},{"value":"NILSSON CHRISTER"},{"value":"docdb"},{"value":"epo"}],[{"value":"US-5551211-A"},{"value":"NILSSON CHRISTER"},{"value":"docdb"},{"value":"intermediate"}],[{"value":"US-5551211-A"},{"value":"NILSSON CHRISTER"},{"value":"patent-office"},{"value":"original"}],[{"value":"US-5551210-A"},{"value":"WILLIAMSON ROBERT L"},{"value":"docdb"},{"value":"epo"}],[{"value":"US-5551210-A"},{"value":"WILLIAMSON ROBERT L"},{"value":"docdb"},{"value":"intermediate"}],[{"value":"US-5551210-A"},{"value":"WILLIAMSON ROBERT L"},{"value":"patent-office"},{"value":"original"}],[{"value":"US-5551209-A"},{"value":"MOLINA ERNEST"},{"value":"docdb"},{"value":"epo"}],[{"value":"US-5551209-A"},{"value":"MOLINA ERNEST"},{"value":"docdb"},{"value":"intermediate"}],[{"value":"US-5551209-A"},{"value":"MOLINA ERNEST"},{"value":"patent-office"},{"value":"original"}],[{"value":"US-5551209-A"},{"value":"CHENEVARD ALEXIS"},{"value":"docdb"},{"value":"epo"}],[{"value":"US-5551209-A"},{"value":"CHENEVARD ALEXIS"},{"value":"docdb"},{"value":"intermediate"}],[{"value":"US-5551209-A"},{"value":"CHENEVARD ALEXIS"},{"value":"patent-office"},{"value":"original"}],[{"value":"US-5551208-A"},{"value":"VAN ERDEN DONALD"},{"value":"docdb"},{"value":"epo"}],[{"value":"US-5551208-A"},{"value":"VAN ERDEN DONALD"},{"value":"docdb"},{"value":"intermediate"}],[{"value":"US-5551208-A"},{"value":"VAN ERDEN DONALD"},{"value":"patent-office"},{"value":"original"}]],"columnNames":[{"name":"ucid","index":0,"aggr":"sum","$$hashKey":"object:1981"},{"name":"name","index":1,"aggr":"sum","$$hashKey":"object:1982"},{"name":"source","index":2,"aggr":"sum","$$hashKey":"object:1983"},{"name":"format","index":3,"aggr":"sum","$$hashKey":"object:1984"}],"rows":[["US-5551211-A","KENNEDY PAUL","docdb","epo"],["US-5551211-A","KENNEDY PAUL","docdb","intermediate"],["US-5551211-A","KENNEDY PAUL","patent-office","original"],["US-5551211-A","PROCHUT RICHARD","docdb","epo"],["US-5551211-A","PROCHUT RICHARD","docdb","intermediate"],["US-5551211-A","PROCHUT RICHARD","patent-office","original"],["US-5551211-A","LOEFSTEDT JOERGEN","docdb","epo"],["US-5551211-A","L+EUML O+EE FSTEDT J+EUML O+EE RGEN","docdb","intermediate"],["US-5551211-A","LOFSTEDT JORGEN","patent-office","original"],["US-5551211-A","YOKOYAMA IKURO","docdb","epo"],["US-5551211-A","YOKOYAMA IKURO","docdb","intermediate"],["US-5551211-A","YOKOYAMA IKURO","patent-office","original"],["US-5551211-A","NILSSON CHRISTER","docdb","epo"],["US-5551211-A","NILSSON CHRISTER","docdb","intermediate"],["US-5551211-A","NILSSON CHRISTER","patent-office","original"],["US-5551210-A","WILLIAMSON ROBERT L","docdb","epo"],["US-5551210-A","WILLIAMSON ROBERT L","docdb","intermediate"],["US-5551210-A","WILLIAMSON ROBERT L","patent-office","original"],["US-5551209-A","MOLINA ERNEST","docdb","epo"],["US-5551209-A","MOLINA ERNEST","docdb","intermediate"],["US-5551209-A","MOLINA ERNEST","patent-office","original"],["US-5551209-A","CHENEVARD ALEXIS","docdb","epo"],["US-5551209-A","CHENEVARD ALEXIS","docdb","intermediate"],["US-5551209-A","CHENEVARD ALEXIS","patent-office","original"],["US-5551208-A","VAN ERDEN DONALD","docdb","epo"],["US-5551208-A","VAN ERDEN DONALD","docdb","intermediate"],["US-5551208-A","VAN ERDEN DONALD","patent-office","original"]]},"dateCreated":"2019-06-05T08:27:16+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1247"},{"text":"%spark\n\nimport sqlContext.implicits._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\n\n  val parquetDir = \"/patents/data/structured/\"\n  val metaFileName = \"meta.parquet\"\n  val titlesFileName = \"titles.parquet\"\n  val abstractsFileName = \"abstracts.parquet\"\n  val inventorsFileName = \"inventors.parquet\"\n\n  val metaDF = sqlContext.read.parquet(parquetDir + metaFileName)\n  val titlesDF = sqlContext.read.parquet(parquetDir + titlesFileName)\n  val abstractsDF = sqlContext.read.parquet(parquetDir + abstractsFileName)\n  val inventorsDF = sqlContext.read.parquet(parquetDir + inventorsFileName)\n","dateUpdated":"2019-06-05T08:33:34+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}}},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1559723236579_-1918787341","id":"20190530-223205_848736595","dateCreated":"2019-06-05T08:27:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1248","dateFinished":"2019-06-05T08:33:56+0000","dateStarted":"2019-06-05T08:33:34+0000","result":{"code":"SUCCESS","type":"TEXT","msg":"import sqlContext.implicits._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\nparquetDir: String = /patents/data/structured/\nmetaFileName: String = meta.parquet\ntitlesFileName: String = titles.parquet\nabstractsFileName: String = abstracts.parquet\ninventorsFileName: String = inventors.parquet\nmetaDF: org.apache.spark.sql.DataFrame = [ucid: string, pubid: int, kind: string, country: string, pubDate: date, fillDate: date]\ntitlesDF: org.apache.spark.sql.DataFrame = [ucid: string, text: string, source: string]\nabstractsDF: org.apache.spark.sql.DataFrame = [ucid: string, text: string, source: string]\ninventorsDF: org.apache.spark.sql.DataFrame = [ucid: string, name: string, source: string, format: string]\n"},"focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1559723467029_-136490350","id":"20190605-083107_114530710","dateCreated":"2019-06-05T08:31:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1860","dateUpdated":"2019-06-05T08:37:34+0000","dateFinished":"2019-06-05T08:37:44+0000","dateStarted":"2019-06-05T08:37:34+0000","result":{"code":"SUCCESS","type":"TEXT","msg":"inventorsGrouped: org.apache.spark.sql.DataFrame = [ucid: string, source: string, names: string]\n+----------------+-------------+--------------------+\n|            ucid|       source|               names|\n+----------------+-------------+--------------------+\n|AU-2017391436-A1|patent-office|         SHAH CHIRAG|\n|AU-2017380872-A1|patent-office|JUNG MARIE-LAURE,...|\n|AU-2017388066-A1|patent-office|AMIDEI JAMES STEP...|\n+----------------+-------------+--------------------+\n\n+----------------+--------------------+-------------+\n|            ucid|                text|       source|\n+----------------+--------------------+-------------+\n|AU-2017380872-A1|Beverage composit...|patent-office|\n|AU-2017388066-A1|Systems and metho...|patent-office|\n|AU-2017391436-A1|Systems and metho...|patent-office|\n+----------------+--------------------+-------------+\n\n+----+----+------+\n|ucid|text|source|\n+----+----+------+\n+----+----+------+\n\n+----+--------+---------+------+\n|ucid|abstract|inventors|source|\n+----+--------+---------+------+\n+----+--------+---------+------+\n\n"},"text":"%spark\n\n\n//inventorsDF.registerTempTable(\"invents\")\n\n\nval inventorsGrouped = inventorsDF.groupBy(\"ucid\",\"source\").agg(concat_ws(\", \", collect_list(\"name\")) as \"names\")\ninventorsGrouped.show\ntitlesDF.show\nabstractsDF.show\n\ntitlesDF\n    .filter(\"source = 'patent-office'\")\n    .join(abstractsDF, abstractsDF(\"ucid\") === titlesDF(\"ucid\") && abstractsDF(\"source\") === titlesDF(\"source\"))\n    .join(inventorsGrouped, inventorsGrouped(\"ucid\") === titlesDF(\"ucid\") && inventorsGrouped(\"source\") === titlesDF(\"source\"))\n    .select(\n            titlesDF(\"ucid\"), \n            abstractsDF(\"text\") as \"abstract\", \n            inventorsGrouped(\"names\") as \"inventors\", \n            inventorsGrouped(\"source\")\n        )\n    .show"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1559723738624_-1762456171","id":"20190605-083538_2147226756","dateCreated":"2019-06-05T08:35:38+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2003"}],"name":"Inventors","id":"2EEWDX83U","angularObjects":{"2BYG9GAN3:shared_process":[],"2C139U1BG:shared_process":[],"2BYWWZJPK:shared_process":[],"2C2VAKPN2:shared_process":[],"2BZC2RPUW:shared_process":[],"2BZQEH9EH:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}